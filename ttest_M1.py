import math
from scipy.stats import t
import sys

def testTEqual(means1, variances1, n1, means2, variances2, n2, alpha=0.01):
  '''
    means1, means2: vector
    variances1, variances2: vector
    n1,n2: integer
    alpha: one minus confidence level
    return True if p-value >= alpha, that is, means are equal.
  '''
  l1,l2 = len(means1),len(means2)
  df = n1 + n2 - 2
  ts = [(means1[i] - means2[i])/math.sqrt(variances1[i]/n1 + variances2[i]/n2) for i in range(min(l1,l2))]
  ps = [(1-t.cdf(abs(ts[i]),df))*2 for i in range(min(l1,l2))]
  return [(ps[i] >= alpha, ps[i]) for i in range(min(l1,l2))]


# Snippet for getting throughputs. Insert it below plt.errorbar.
'''
      if printValuesForTTest:
          print('#',end='')
          print(algorithmsLabels[a],holoSubStr[h],"no ad hoc",sep='-------')
          print('means'+'Alg = ',end='')
          print(*dataMeanAlg[:,a,h,option], sep=', ')
          print('vari'+'Alg = ',end='')
          print(*dataVariAlg[:,a,h,option], sep=', ')
          print('#',end='')
          print(algorithmsLabels[a],holoSubStr[h],"m=1",sep='-------')
          print('means'+'M1 = ',end='')
          print(*dataMean[:,a,h,option], sep=', ')
          print('vari'+'M1 = ',end='')
          print(*dataVari[:,a,h,option], sep=', ')
          textResult = algorithmsLabels[a]+" "+holoSubStr[h]
          print("printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,\""+textResult+"\")")
'''

def printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,textResult):
  vec = range(20,301,20)
  for i in range(len(meansAlg)):
    RE = testTEqual([meansAlg[i]], [variAlg[i]], n1, [meansM1[i]], [variM1[i]], n2)
    if RE[0][0] == False:
      print(textResult,vec[i])
      print(RE)

n1 = n2 = 40

#SQF-------nonholo-------no ad hoc
meansAlg = 283.51, 288.645, 293.53249999999997, 299.8125, 304.52, 311.4575, 320.2625, 328.3875, 340.6, 352.6325, 364.65250000000003, 381.76750000000004, 396.2875, 415.81000000000006, 435.65749999999997
variAlg = 40.402399999999986, 43.63647499999993, 23.45669374999996, 24.567093750000048, 25.35560000000003, 17.776443749999956, 25.93384375, 21.990593749999988, 39.8645, 41.25069374999993, 25.527993749999943, 101.07669374999986, 44.16909375000001, 135.74339999999992, 292.46844375000006
#SQF-------nonholo-------m=1
meansM1 = 277.515, 287.68500000000006, 293.2275, 298.84, 308.4925, 311.40749999999997, 319.925, 329.665, 341.57000000000005, 354.8975, 364.00249999999994, 377.675, 391.09250000000003, 411.1625, 423.3325
variM1 = 124.25727499999998, 53.88127499999996, 42.993493749999956, 23.81539999999999, 132.80969375, 46.811193749999994, 27.33687500000007, 114.50227499999994, 61.13160000000005, 149.91524375, 81.73074374999996, 62.896374999999956, 32.51869375, 199.46834374999986, 62.90819375000001
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"SQF nonholo")
#SQF-------holo-------no ad hoc
meansAlg = 274.05250000000007, 280.3525, 286.61499999999995, 298.87, 312.2099999999999, 331.985, 346.73249999999996, 357.0625, 367.215, 376.40500000000003, 389.3875, 398.275, 409.775, 420.895, 435.4875
variAlg = 80.84049375000006, 56.51199374999986, 46.77327499999991, 67.32760000000002, 48.86290000000001, 41.03377499999999, 46.212693750000064, 42.31284374999997, 24.124774999999993, 21.493975000000017, 26.158593750000005, 28.112375000000014, 37.78937500000004, 25.73397499999995, 26.572593750000067
#SQF-------holo-------m=1
meansM1 = 270.61, 279.7025, 287.1025, 299.8375, 314.3075, 328.7075, 343.5375, 354.0875, 363.055, 378.4025, 389.12, 396.15749999999997, 407.96750000000003, 420.79749999999996, 433.2825000000001
variM1 = 117.14939999999993, 64.99624375000003, 15.320743749999991, 60.60584374999996, 57.97069374999997, 82.63669375000002, 87.12484375000005, 45.41609375000003, 33.871975000000006, 62.89974374999997, 61.759100000000046, 41.636943749999965, 35.295193749999996, 28.735743749999973, 39.85244374999998
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"SQF holo")
#TRVF-------nonholo-------no ad hoc
meansAlg = 186.02249999999998, 209.60500000000002, 251.385, 301.85499999999996, 343.90250000000003, 389.95500000000004, 427.6325, 464.98, 512.735, 574.485, 636.7625, 681.2149999999999, 731.5675, 805.825, 847.515
variAlg = 97.08774375000004, 131.78097500000004, 437.39277500000014, 565.3529750000001, 833.4572437499997, 848.378975, 591.08019375, 756.4211000000003, 796.8797749999998, 1192.527775, 1288.4918437500003, 1617.729275, 2198.2651937500004, 2680.7948749999996, 1882.8347750000005
#TRVF-------nonholo-------m=1
meansM1 = 183.195, 219.35249999999996, 256.34499999999997, 301.21999999999997, 338.95500000000004, 387.335, 425.2674999999999, 470.3, 522.0799999999999, 578.13, 623.0400000000001, 692.3, 742.7225000000001, 786.665, 861.9275000000001
variM1 = 73.02897499999996, 247.36349375, 345.62047500000006, 473.8346, 409.7404749999999, 615.720275, 616.7316937500001, 842.6515000000003, 962.5955999999999, 1964.2976000000003, 1654.6984, 2622.75, 2327.1077437499994, 1737.1242749999997, 1360.3619937499996
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"TRVF nonholo")
#TRVF-------holo-------no ad hoc
meansAlg = 167.63000000000002, 181.6, 219.5125, 249.17750000000007, 276.2375, 307.145, 333.32, 359.0875, 386.2225, 416.8575000000001, 444.625, 481.7575, 521.46, 549.8725000000001, 586.1625
variAlg = 49.48560000000002, 91.17799999999997, 147.03009374999996, 205.7672437500001, 91.75834375000004, 212.618475, 189.65560000000005, 194.80259375000006, 284.19774375, 702.1089437499998, 366.93937500000004, 735.7779437499997, 1021.3608999999999, 539.13699375, 957.7453437499995
#TRVF-------holo-------m=1
meansM1 = 166.075, 185.9025, 216.8775, 245.59750000000003, 276.725, 306.3125, 331.48, 361.8075, 386.86, 423.03499999999997, 449.5799999999999, 478.41, 512.1375, 552.7725, 588.32
variM1 = 36.48437500000002, 69.83474374999999, 180.44974375, 143.96524374999998, 230.08837499999998, 202.6800937500001, 169.24960000000007, 187.50019375000002, 474.7479, 907.2002749999999, 778.9155999999997, 638.5158999999996, 819.63134375, 829.2044937500004, 973.1246000000004
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"TRVF holo")
