import math
from scipy.stats import t

def testTEqual(means1, variances1, n1, means2, variances2, n2, alpha=0.01):
  '''
    means1, means2: vector
    variances1, variances2: vector
    n1,n2: integer
    alpha: one minus confidence level
    return True if p-value >= alpha, that is, means are equal.
  '''
  l1,l2 = len(means1),len(means2)
  df = n1 + n2 - 2
  ts = [(means1[i] - means2[i])/math.sqrt(variances1[i]/n1 + variances2[i]/n2) for i in range(min(l1,l2))]
  ps = [(1-t.cdf(abs(ts[i]),df))*2 for i in range(min(l1,l2))]
  return [(ps[i] >= alpha, ps[i]) for i in range(min(l1,l2))]


# Snippet for getting throughputs. Insert it below plt.errorbar.
'''
      if printValuesForTTest:
          print('#',end='')
          print(algorithmsLabels[a],holoSubStr[h],"no ad hoc",sep='-------')
          print('means'+'Alg = ',end='')
          print(*dataMeanAlg[:,a,h,option], sep=', ')
          print('vari'+'Alg = ',end='')
          print(*dataVariAlg[:,a,h,option], sep=', ')
          print('#',end='')
          print(algorithmsLabels[a],holoSubStr[h],"m=1",sep='-------')
          print('means'+'M1 = ',end='')
          print(*dataMean[:,a,h,option], sep=', ')
          print('vari'+'M1 = ',end='')
          print(*dataVari[:,a,h,option], sep=', ')
          textResult = algorithmsLabels[a]+" "+holoSubStr[h]
          print("printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,\""+textResult+"\")")
'''

def printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,textResult):
  vec = range(20,301,20)
  for i in range(len(meansAlg)):
    RE = testTEqual([meansAlg[i]], [variAlg[i]], n1, [meansM1[i]], [variM1[i]], n2)
    if RE[0][0] == False:
      print(textResult,vec[i])
      print(RE)

n1 = n2 = 40

#['No c.', 'TRVF']-------nonholo
meansNoc = 227.6625, 257.6275, 275.79499999999996, 319.95, 376.63500000000005, 424.43500000000006, 474.40500000000003, 548.1, 614.595, 696.8975
variNoc = 1923.13184375, 892.3614937499999, 302.37097500000016, 379.49449999999996, 498.92177500000014, 670.797275, 481.8829750000001, 647.8669999999998, 844.410975, 1275.2952437499998
meansTRVF = 247.15, 309.8375, 373.0575, 400.78000000000003, 438.71750000000003, 475.9174999999999, 530.77, 576.4799999999999, 624.475, 668.4525
variTRVF = 1295.4804999999997, 1347.06584375, 7622.160943750001, 1683.8120999999999, 2440.770443750001, 1627.37644375, 1373.0615999999995, 2238.5601, 1593.4118749999998, 2407.7574937500003
printResult(meansNoc,variNoc,meansTRVF,variTRVF,n1,n2,"SQF knowing nonholo")
#['No c.', 'TRVF']-------holo
meansNoc = 204.4625, 233.9925, 252.65750000000003, 263.6975, 279.5475, 312.58000000000004, 351.4225, 394.76000000000005, 445.2425, 502.3549999999999
variNoc = 1426.6758437500005, 1048.7791937499999, 701.8809437500001, 755.9192437500001, 251.04999374999997, 249.74659999999994, 333.10124374999987, 268.1174, 490.50244375, 579.1399750000003
meansTRVF = 231.8225, 262.56499999999994, 290.005, 317.79499999999996, 343.54499999999996, 375.63500000000005, 407.7475, 436.7675000000001, 462.77250000000004, 494.1
variTRVF = 344.1442437500001, 590.3887750000001, 749.9184750000001, 425.81847500000003, 462.90347499999996, 798.9412750000002, 485.6969937500001, 846.27369375, 1691.8634937499999, 1164.8894999999998
printResult(meansNoc,variNoc,meansTRVF,variTRVF,n1,n2,"SQF knowing holo")

'''-------------------------------------------------'''
'''------------------- Total time ------------------'''
'''-------------------------------------------------'''

#SQF-------nonholo-------no ad hoc
meansAlg = 283.51, 288.645, 293.53249999999997, 299.8125, 304.52, 311.4575, 320.2625, 328.3875, 340.6, 352.6325, 364.65250000000003, 381.76750000000004, 396.2875, 415.81000000000006, 435.65749999999997
variAlg = 40.402399999999986, 43.63647499999993, 23.45669374999996, 24.567093750000048, 25.35560000000003, 17.776443749999956, 25.93384375, 21.990593749999988, 39.8645, 41.25069374999993, 25.527993749999943, 101.07669374999986, 44.16909375000001, 135.74339999999992, 292.46844375000006
#SQF-------nonholo-------m=1
meansM1 = 282.54499999999996, 290.02250000000004, 294.78000000000003, 302.03499999999997, 304.65250000000003, 311.25, 321.82250000000005, 329.9375, 341.40250000000003, 349.6975, 366.17749999999995, 376.10249999999996, 393.755, 408.47, 426.96999999999997
variM1 = 110.5884750000001, 90.07924375000003, 76.27309999999993, 114.637775, 32.09649374999998, 45.004999999999974, 32.80424375, 80.76484374999998, 45.50974374999997, 24.33174374999998, 118.32024374999996, 31.95124375000001, 61.58947499999996, 45.484100000000026, 86.01409999999994
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"SQF nonholo")
#SQF-------holo-------no ad hoc
meansAlg = 274.05250000000007, 280.3525, 286.61499999999995, 298.87, 312.2099999999999, 331.985, 346.73249999999996, 357.0625, 367.215, 376.40500000000003, 389.3875, 398.275, 409.775, 420.895, 435.4875
variAlg = 80.84049375000006, 56.51199374999986, 46.77327499999991, 67.32760000000002, 48.86290000000001, 41.03377499999999, 46.212693750000064, 42.31284374999997, 24.124774999999993, 21.493975000000017, 26.158593750000005, 28.112375000000014, 37.78937500000004, 25.73397499999995, 26.572593750000067
#SQF-------holo-------m=1
meansM1 = 274.5475, 280.9225, 289.41999999999996, 300.0475, 314.8825, 328.8275, 345.85749999999996, 354.115, 365.5525, 377.2925, 386.8875, 401.1875, 409.5425, 421.3325, 433.10249999999996
variM1 = 106.49199374999998, 45.14574375000001, 64.54560000000001, 44.946993749999976, 57.03694375, 59.60099375, 35.79994374999997, 50.07777500000003, 43.564493749999954, 38.09919375000002, 46.02959374999997, 95.10009375000001, 51.03644374999998, 21.715193750000015, 27.995743749999995
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"SQF holo")
#TRVF-------nonholo-------no ad hoc
meansAlg = 186.02249999999998, 209.60500000000002, 251.385, 301.85499999999996, 343.90250000000003, 389.95500000000004, 427.6325, 464.98, 512.735, 574.485, 636.7625, 681.2149999999999, 731.5675, 805.825, 847.515
variAlg = 97.08774375000004, 131.78097500000004, 437.39277500000014, 565.3529750000001, 833.4572437499997, 848.378975, 591.08019375, 756.4211000000003, 796.8797749999998, 1192.527775, 1288.4918437500003, 1617.729275, 2198.2651937500004, 2680.7948749999996, 1882.8347750000005
#TRVF-------nonholo-------m=1
meansM1 = 185.34, 213.33499999999998, 258.7875, 301.11499999999995, 343.9975, 384.78249999999997, 433.62749999999994, 478.3875, 530.28, 575.655, 634.42, 699.6625, 740.3725, 794.17, 867.8950000000001
variM1 = 36.870899999999985, 110.66377499999996, 420.67709374999987, 309.67127500000004, 514.2767437500003, 410.0804437500001, 879.2529937500001, 1107.53759375, 880.3476, 1192.909975, 916.7975999999999, 1317.52534375, 2488.688493750001, 1748.0075999999985, 3619.8469750000004
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"TRVF nonholo")
#TRVF-------holo-------no ad hoc
meansAlg = 167.63000000000002, 181.6, 219.5125, 249.17750000000007, 276.2375, 307.145, 333.32, 359.0875, 386.2225, 416.8575000000001, 444.625, 481.7575, 521.46, 549.8725000000001, 586.1625
variAlg = 49.48560000000002, 91.17799999999997, 147.03009374999996, 205.7672437500001, 91.75834375000004, 212.618475, 189.65560000000005, 194.80259375000006, 284.19774375, 702.1089437499998, 366.93937500000004, 735.7779437499997, 1021.3608999999999, 539.13699375, 957.7453437499995
#TRVF-------holo-------m=1
meansM1 = 166.93, 187.29500000000002, 217.66750000000002, 247.55749999999998, 279.26000000000005, 306.55, 335.43500000000006, 361.7, 386.7, 421.32, 444.91999999999996, 483.525, 523.6650000000001, 553.8475000000001, 580.1125
variM1 = 43.05009999999999, 118.38747500000004, 101.44269375000002, 129.88744374999993, 197.69789999999992, 206.00950000000017, 211.883275, 352.7385, 403.1405, 783.0961, 347.59560000000005, 653.7728749999997, 1346.6302749999998, 742.8469937499999, 944.1545937499999
printResult(meansAlg,variAlg,meansM1,variM1,n1,n2,"TRVF holo")




